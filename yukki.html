<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Yukki's Cozy Corner üêïüíú</title>

<!-- Matter.js —Ñ–∏–∑–∏–∫–∞ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>

<style>
  /* --- –û–±—â–∏–π —É—é—Ç–Ω—ã–π —Å—Ç–∏–ª—å --- */
  body {
    margin: 0;
    background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    overflow: hidden;
    user-select: none;
  }

  #container {
    position: relative;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
  }

  /* –§–æ–Ω —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –Ω–µ–∂–Ω—ã—Ö –ª–∞–ø–æ–∫ */
  #paw-background {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
    background: url('https://i.imgur.com/8YeoTWQ.png') repeat;
    opacity: 0.07;
    animation: pawMove 20s linear infinite;
  }
  @keyframes pawMove {
    from { background-position: 0 0; }
    to { background-position: 400px 400px; }
  }

  /* –Æ–∫–∫–∏ –∏ –µ—ë –æ–±–ª–∞—á–∫–∏ */
  #yukki-container {
    position: absolute;
    bottom: 30px;
    left: 40px;
    width: 180px;
    user-select: none;
    cursor: pointer;
  }

  #yukki-avatar {
    width: 180px;
    border-radius: 20px;
    box-shadow: 0 0 15px rgba(255, 192, 203, 0.7);
  }

  /* –†–µ—á—å –∏ –º—ã—Å–ª–∏ */
  .speech-bubble, .thought-bubble {
    position: absolute;
    max-width: 230px;
    padding: 10px 15px;
    border-radius: 20px;
    font-size: 16px;
    line-height: 1.3;
    font-weight: 600;
    color: #222;
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }

  .speech-bubble {
    background: #fff0f6;
    border: 2px solid #ff8fc3;
    bottom: 130px;
    left: 50px;
  }

  .thought-bubble {
    background: #f0f0ff;
    border: 2px solid #8a8afe;
    bottom: 190px;
    left: 20px;
    font-style: italic;
    color: #555;
  }

  /* –§–∏–∑–∏—á–µ—Å–∫–∏–π –º–∏—Ä - –∫–∞–Ω–≤–∞—Å */
  #physics-canvas {
    position: absolute;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    pointer-events: none;
    z-index: 1;
  }

  /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ–Ω–æ–º */
  #bg-buttons {
    position: fixed;
    top: 15px;
    right: 15px;
    display: flex;
    gap: 10px;
    z-index: 1000;
  }

  .bg-btn {
    background: #fff;
    border: none;
    border-radius: 12px;
    padding: 8px 14px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    transition: background 0.3s;
  }
  .bg-btn:hover {
    background: #ffbad2;
  }

  /* –õ–µ–≥–∫–∏–π –ø–æ–ª */
  #floor {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 50px;
    background: #6f4b3e;
    box-shadow: inset 0 5px 20px #4b2e20;
    z-index: 5;
  }

  /* –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è | –∏ __ */
  .draggable-bar {
    position: absolute;
    top: 10px;
    width: 40px;
    height: 10px;
    background: #fff;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    cursor: grab;
    user-select: none;
    z-index: 900;
  }

  #bar-1 {
    left: 15px;
  }
  #bar-2 {
    left: 70px;
  }

  /* –õ–∞–ø–∫–∏ –≤–Ω–∏–∑—É –¥–ª—è —É—é—Ç–∞ */
  #bottom-paws {
    position: fixed;
    bottom: 5px;
    right: 15px;
    opacity: 0.2;
    width: 180px;
    user-select: none;
  }

  /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è/–∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è */
  .fade-in {
    animation: fadeIn 0.6s forwards;
  }
  .fade-out {
    animation: fadeOut 0.6s forwards;
  }
  @keyframes fadeIn {
    from {opacity: 0;}
    to {opacity: 1;}
  }
  @keyframes fadeOut {
    from {opacity: 1;}
    to {opacity: 0;}
  }
</style>
</head>
<body>

<div id="container">
  <div id="paw-background"></div>

  <canvas id="physics-canvas"></canvas>
  <div id="floor"></div>

  <div id="yukki-container" title="Click Yukki!">
    <img id="yukki-avatar" src="Yukki.png" alt="Yukki avatar" />
    <div class="thought-bubble" id="thought-bubble" style="display:none;">üçó üêï ü•© ü¶¥ üòá üêæ</div>
    <div class="speech-bubble" id="speech-bubble" style="display:none;"></div>
  </div>

  <div id="bg-buttons">
    <button class="bg-btn" data-bg="default">Soft Purple</button>
    <button class="bg-btn" data-bg="pink">Pink Glow</button>
    <button class="bg-btn" data-bg="blue">Blue Mist</button>
  </div>

  <div class="draggable-bar" id="bar-1" title="Drag me!">|</div>
  <div class="draggable-bar" id="bar-2" title="Drag me too!">__</div>

  <img id="bottom-paws" src="https://i.imgur.com/8YeoTWQ.png" alt="Cute paws" />

</div>

<script>
  // --- Matter.js setup ---
  const { Engine, Render, Runner, Bodies, Composite, Mouse, MouseConstraint, Events, Body, Vector } = Matter;

  const engine = Engine.create();
  const world = engine.world;

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏ –∏ –≤–æ–∑–¥—É—Ö–∞
  engine.gravity.y = 1; // –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è

  // –ö–∞–Ω–≤–∞—Å –ø–æ–¥ Matter.js
  const canvas = document.getElementById('physics-canvas');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  // Matter.js —Ä–µ–Ω–¥–µ—Ä–µ—Ä –±–µ–∑ –≤–∏–¥–∏–º–æ–≥–æ –∫–∞–Ω–≤–∞—Å–∞ (–º—ã —Å–∞–º–∏ —Ä–∏—Å—É–µ–º)
  const render = Render.create({
    canvas: canvas,
    engine: engine,
    options: {
      width: window.innerWidth,
      height: window.innerHeight,
      wireframes: false,
      background: 'transparent',
      pixelRatio: window.devicePixelRatio,
      showAngleIndicator: false
    }
  });

  Render.run(render);
  const runner = Runner.create();
  Runner.run(runner, engine);

  // –ü–æ–ª (floor) - —Å—Ç–∞—Ç–∏—á–Ω—ã–π
  const floorHeight = 50;
  const floor = Bodies.rectangle(
    window.innerWidth / 2,
    window.innerHeight - floorHeight / 2,
    window.innerWidth,
    floorHeight,
    {
      isStatic: true,
      render: { fillStyle: '#6f4b3e' }
    }
  );
  Composite.add(world, floor);

  // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã - –∏–≥—Ä—É—à–∫–∏
  const toyRadius = 25;

  // ‚öΩ –ú—è—á ‚Äî –ª—ë–≥–∫–∏–π, —Å –Ω–µ–±–æ–ª—å—à–æ–π –º–∞—Å—Å–æ–π, —á—Ç–æ–±—ã –∫–∞—Ç–∞–ª—Å—è –ø–ª–∞–≤–Ω–æ
  const ball = Bodies.circle(window.innerWidth + 50, 200, toyRadius, {
    restitution: 0.8,
    frictionAir: 0.02,
    density: 0.0005,
    render: {
      sprite: { texture: 'https://cdn-icons-png.flaticon.com/512/833/833314.png', xScale: 0.13, yScale: 0.13 }
    },
    label: 'ball'
  });

  // ü¶¥ –ö–æ—Å—Ç–æ—á–∫–∞ ‚Äî —á—É—Ç—å —Ç—è–∂–µ–ª–µ–µ, —á—É—Ç—å –º–µ–Ω–µ–µ —É–ø—Ä—É–≥–∞—è
  const bone = Bodies.circle(window.innerWidth + 150, 150, toyRadius * 0.8, {
    restitution: 0.6,
    frictionAir: 0.03,
    density: 0.001,
    render: {
      sprite: { texture: 'https://cdn-icons-png.flaticon.com/512/616/616408.png', xScale: 0.1, yScale: 0.1 }
    },
    label: 'bone'
  });

  // ‚öæ –ú—è—á–∏–∫ (–Æ–∫–∫–∏–Ω–∞ –∏–≥—Ä—É—à–∫–∞) ‚Äî –±–æ–ª–µ–µ —É–ø—Ä—É–≥–∏–π, –Ω–æ —Ç–æ–∂–µ –ª—ë–≥–∫–∏–π
  const toyBall = Bodies.circle(window.innerWidth + 100, 250, toyRadius * 0.9, {
    restitution: 0.9,
    frictionAir: 0.015,
    density: 0.0007,
    render: {
      sprite: { texture: 'https://cdn-icons-png.flaticon.com/512/2747/2747503.png', xScale: 0.11, yScale: 0.11 }
    },
    label: 'toyBall'
  });

  // –î–æ–±–∞–≤–∏–º —Å—Ä–∞–∑—É –≤—Å–µ –≤ –º–∏—Ä
  Composite.add(world, [ball, bone, toyBall]);

  // –í–Ω–∞—á–∞–ª–µ –∏–≥—Ä—É—à–∫–∏ –∑–∞ —ç–∫—Ä–∞–Ω–æ–º –∏ –Ω–µ–≤–∏–¥–∏–º—ã, –±—É–¥–µ–º –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ö –ø–æ–∑–∂–µ

  // –¢–∞–π–º–µ—Ä—ã –¥–ª—è –ø–æ—è–≤–ª–µ–Ω–∏—è
  let lastActivityTime = Date.now();
  let ballVisible = false;
  let boneVisible = false;
  let toyBallVisible = false;

  // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –Æ–∫–∫–∏ –∏ –µ—ë –æ–±–ª–∞–∫–æ–≤
  const yukkiContainer = document.getElementById('yukki-container');
  const yukkiAvatar = document.getElementById('yukki-avatar');
  const thoughtBubble = document.getElementById('thought-bubble');
  const speechBubble = document.getElementById('speech-bubble');

  // –ú–∞—Å—Å–∏–≤ –º—ã—Å–ª–µ–π
  const thoughtsArray = ['üçó', 'üêï', 'ü•©', 'ü¶¥', 'üòá', 'üêæ'];

  // –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã –º—ã—Å–ª–∏
  function changeThought() {
    const randomIndex = Math.floor(Math.random() * thoughtsArray.length);
    thoughtBubble.textContent = thoughtsArray[randomIndex];
  }

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏ —Å–∫—Ä—ã–≤–∞–µ–º —Ä–µ—á—å/–º—ã—Å–ª–∏
  function showThought() {
    speechBubble.style.display = 'none';
    thoughtBubble.style.display = 'block';
  }
  function showSpeech(text) {
    speechBubble.textContent = text;
    speechBubble.style.display = 'block';
    thoughtBubble.style.display = 'none';
  }
  function hideBubbles() {
    speechBubble.style.display = 'none';
    thoughtBubble.style.display = 'none';
  }

  // –ù–∞—á–∏–Ω–∞–µ–º –º–µ–Ω—è—Ç—å –º—ã—Å–ª–∏ —Ä–∞–∑ –≤ 4 —Å–µ–∫—É–Ω–¥—ã
  changeThought();
  setInterval(changeThought, 4000);

  // –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –Æ–∫–∫–∏ - –º–µ–Ω—è–µ—Ç –º—ã—Å–ª—å –Ω–∞ ü•∞ –∏ –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
  yukkiContainer.addEventListener('click', () => {
    showSpeech("Hi! I'm Yukki! ü•∞");
  });

  // –ö–æ–≥–¥–∞ —â—ë–ª–∫–∞–µ—à—å "–£–π—Ç–∏" (–∫–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞—Å—Ç—Å—è –ø–æ–∑–∂–µ) - —Å–Ω–∞—á–∞–ª–∞ –Æ–∫–∫–∏ –ø—Ä–æ—Å–∏—Ç –Ω–µ —É—Ö–æ–¥–∏—Ç—å, –º–µ–Ω—è–µ—Ç—Å—è –∞–≤–∞—Ç–∞—Ä–∫–∞ –Ω–∞ –≥—Ä—É—Å—Ç–Ω—É—é, –ø–æ—Ç–æ–º –≤—Ç–æ—Ä–æ–π –∫–ª–∏–∫ —É–≤–æ–¥–∏—Ç —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
  let leaveClickedOnce = false;

  function createLeaveButton() {
    const btn = document.createElement('button');
    btn.textContent = 'Leave';
    btn.style.position = 'fixed';
    btn.style.bottom = '15px';
    btn.style.right = '15px';
    btn.style.padding = '10px 20px';
    btn.style.borderRadius = '15px';
    btn.style.border = 'none';
    btn.style.background = '#ff8fc3';
    btn.style.color = '#fff';
    btn.style.fontWeight = '700';
    btn.style.cursor = 'pointer';
    btn.style.zIndex = '1100';

    btn.addEventListener('click', () => {
      if (!leaveClickedOnce) {
        showSpeech("Please don't leave me ü•∫");
        yukkiAvatar.src = 'Yukki_sad.png';
        leaveClickedOnce = true;

        setTimeout(() => {
          yukkiAvatar.src = 'Yukki.png';
          hideBubbles();
          leaveClickedOnce = false;
        }, 4000);
      } else {
        window.location.href = "https://yukki-dog.github.io/wallpapers/home_page.html";
      }
    });

    document.body.appendChild(btn);
  }
  createLeaveButton();

  // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º—ã—à—å, –∫–ª–∞–≤–∏—à–∏)
  function updateActivity() {
    lastActivityTime = Date.now();
  }
  window.addEventListener('mousemove', updateActivity);
  window.addEventListener('keydown', updateActivity);
  window.addEventListener('click', updateActivity);

  // Matter.js –º—ã—à—å –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∏–≥—Ä—É—à–µ–∫ –∏ –±–∞—Ä–∞
  const mouse = Mouse.create(canvas);
  const mouseConstraint = MouseConstraint.create(engine, {
    mouse: mouse,
    constraint: {
      stiffness: 0.2,
      render: {visible: false}
    }
  });
  Composite.add(world, mouseConstraint);

  // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –±–∞—Ä–∞ –∏ __
  const bar1 = document.getElementById('bar-1');
  const bar2 = document.getElementById('bar-2');

  // –°–æ–∑–¥–∞–µ–º —Ç–µ–ª–∞ –¥–ª—è –±–∞—Ä–æ–≤, —á—Ç–æ–±—ã –æ–Ω–∏ –±—ã–ª–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ —Ç–µ–ª–∞–º–∏ –¥–ª—è —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
  const barWidth = 60;
  const barHeight = 14;

  // –ü–æ–∑–∏—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  let bar1Pos = { x: 80, y: 30 };
  let bar2Pos = { x: 150, y: 30 };

  const bar1Body = Bodies.rectangle(bar1Pos.x, bar1Pos.y, barWidth, barHeight, {
    isStatic: true,
    label: 'bar1',
    render: { fillStyle: '#ffffff' }
  });
  const bar2Body = Bodies.rectangle(bar2Pos.x, bar2Pos.y, barWidth, barHeight, {
    isStatic: true,
    label: 'bar2',
    render: { fillStyle: '#ffffff' }
  });

  Composite.add(world, [bar1Body, bar2Body]);

  // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–æ–∂–µ–Ω–∏—è HTML-—ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±–∞—Ä–æ–≤ –ø–æ —Ç–µ–ª–∞–º Matter.js
  function updateBarsPosition() {
    bar1.style.left = (bar1Body.position.x - barWidth/2) + 'px';
    bar1.style.top = (bar1Body.position.y - barHeight/2) + 'px';

    bar2.style.left = (bar2Body.position.x - barWidth/2) + 'px';
    bar2.style.top = (bar2Body.position.y - barHeight/2) + 'px';
  }
  updateBarsPosition();

  // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –±–∞—Ä–æ–≤ –º—ã—à—å—é –≤—Ä—É—á–Ω—É—é (html —ç–ª–µ–º–µ–Ω—Ç—ã)
  let draggingBar = null;
  let dragOffset = {x:0, y:0};

  function onMouseDownBar(e) {
    draggingBar = e.target;
    dragOffset.x = e.clientX - draggingBar.offsetLeft;
    dragOffset.y = e.clientY - draggingBar.offsetTop;
    draggingBar.style.cursor = 'grabbing';
  }
  function onMouseMoveBar(e) {
    if (draggingBar) {
      let newX = e.clientX - dragOffset.x;
      let newY = e.clientY - dragOffset.y;

      // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —ç–∫—Ä–∞–Ω–∞ (–ø—Ä–∏–º–µ—Ä)
      newX = Math.max(20, Math.min(window.innerWidth - 80, newX));
      newY = Math.max(10, Math.min(100, newY));

      draggingBar.style.left = newX + 'px';
      draggingBar.style.top = newY + 'px';

      // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–ª–æ Matter.js —á—Ç–æ–±—ã —Ñ–∏–∑–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–ª–∞ —Å –Ω–æ–≤—ã–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º
      if (draggingBar.id === 'bar-1') {
        Body.setPosition(bar1Body, {x: newX + barWidth/2, y: newY + barHeight/2});
      } else if (draggingBar.id === 'bar-2') {
        Body.setPosition(bar2Body, {x: newX + barWidth/2, y: newY + barHeight/2});
      }
    }
  }
  function onMouseUpBar() {
    if (draggingBar) {
      draggingBar.style.cursor = 'grab';
      draggingBar = null;
    }
  }
  bar1.addEventListener('mousedown', onMouseDownBar);
  bar2.addEventListener('mousedown', onMouseDownBar);
  window.addEventListener('mousemove', onMouseMoveBar);
  window.addEventListener('mouseup', onMouseUpBar);

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –ø—Ä—è—á–µ–º –∏–≥—Ä—É—à–∫–∏ –∑–∞ —ç–∫—Ä–∞–Ω–æ–º (—Å–ø—Ä–∞–≤–∞) –∏ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –º–∏—Ä —Å—Ä–∞–∑—É
  ball.isSleeping = true;
  bone.isSleeping = true;
  toyBall.isSleeping = true;

  // –°–¥–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø–ª–∞–≤–Ω–æ–≥–æ –≤—ã–µ–∑–¥–∞ –º—è—á–∞ —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ
  function showBall() {
    if (ballVisible) return;
    ballVisible = true;

    Body.setPosition(ball, { x: window.innerWidth + 40, y: 200 });
    Body.setVelocity(ball, { x: -4, y: 0 });
    ball.isSleeping = false;
    Composite.add(world, ball);
  }

  // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –∫–æ—Å—Ç–æ—á–∫–∏
  function showBone() {
    if (boneVisible) return;
    boneVisible = true;

    Body.setPosition(bone, { x: window.innerWidth + 100, y: 150 });
    Body.setVelocity(bone, { x: -3, y: 0 });
    bone.isSleeping = false;
    Composite.add(world, bone);
  }

  // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –∏–≥—Ä—É—à–µ—á–Ω–æ–≥–æ –º—è—á–∞
  function showToyBall() {
    if (toyBallVisible) return;
    toyBallVisible = true;

    Body.setPosition(toyBall, { x: window.innerWidth + 70, y: 250 });
    Body.setVelocity(toyBall, { x: -3.5, y: 0 });
    toyBall.isSleeping = false;
    Composite.add(world, toyBall);
  }

  // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –±–µ–∑–¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∏–≥—Ä—É—à–µ–∫
  function checkIdle() {
    const now = Date.now();
    const idleTime = now - lastActivityTime;

    // ‚öΩ –ø–æ—Å–ª–µ 30 —Å–µ–∫—É–Ω–¥
    if (idleTime > 30000 && !ballVisible) {
      showBall();
    }

    // ü¶¥ –ø–æ—Å–ª–µ 45 —Å–µ–∫—É–Ω–¥
    if (idleTime > 45000 && !boneVisible) {
      showBone();
    }

    // ‚öæ –ø–æ—Å–ª–µ 60 —Å–µ–∫—É–Ω–¥
    if (idleTime > 60000 && !toyBallVisible) {
      showToyBall();
    }
  }

  setInterval(checkIdle, 1000);

  // –ö–æ–≥–¥–∞ –º—è—á –∫–∞—Ç–∏—Ç—Å—è –∏ –¥–æ–π–¥—ë—Ç –ø–æ—á—Ç–∏ –¥–æ –∫—Ä–∞—è —Å–ª–µ–≤–∞, —á—Ç–æ–±—ã –æ–Ω –ø–ª–∞–≤–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è
  Events.on(engine, 'beforeUpdate', () => {
    if (ballVisible) {
      if (ball.position.x < 70 && ball.velocity.x < 0) {
        Body.setVelocity(ball, { x: ball.velocity.x * 0.93, y: ball.velocity.y });
        if (Math.abs(ball.velocity.x) < 0.05) {
          Body.setVelocity(ball, { x: 0, y: 0 });
          Body.setPosition(ball, { x: 70, y: ball.position.y });
          ball.isSleeping = true;
        }
      }
    }
  });

  // –ü–æ–¥—Å–∫–∞–∑–∫–∏ —Å–º–µ–Ω—ã —Ñ–æ–Ω–∞
  const bgButtons = document.querySelectorAll('.bg-btn');
  bgButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      if (btn.dataset.bg === 'default') {
        document.body.style.background = 'linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%)';
      } else if (btn.dataset.bg === 'pink') {
        document.body.style.background = 'linear-gradient(135deg, #ffb6c1 0%, #ffc0cb 100%)';
      } else if (btn.dataset.bg === 'blue') {
        document.body.style.background = 'linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%)';
      }
    });
  });

  // Resize handler
  window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    Body.setPosition(floor, {x: window.innerWidth/2, y: window.innerHeight - floorHeight/2});
    Body.setVertices(floor, [
      { x: 0, y: window.innerHeight },
      { x: window.innerWidth, y: window.innerHeight },
      { x: window.innerWidth, y: window.innerHeight - floorHeight },
      { x: 0, y: window.innerHeight - floorHeight }
    ]);
  });

  // -----------------------------------------------------
  // --- –ü—Ç–µ–Ω—á–∏–∫ –∏ —à–∞—Ä–∏–∫ (–ø—Ç–∏—á–∫–∞ üê§, —à–∞—Ä–∏–∫ üéà) –∏ —Ä–µ–∞–∫—Ü–∏–∏ ---

  // –°–æ–∑–¥–∞–¥–∏–º –ø—Ç–∏—á–∫—É –∫–∞–∫ html —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–π
  const chick = document.createElement('div');
  chick.textContent = 'üê§';
  chick.style.position = 'absolute';
  chick.style.fontSize = '38px';
  chick.style.left = window.innerWidth + 'px';
  chick.style.top = '180px';
  chick.style.transition = 'left 3s linear';
  chick.style.cursor = 'pointer';
  chick.style.userSelect = 'none';
  chick.style.zIndex = '100';

  document.body.appendChild(chick);

  // –ü—Ç–∏—Ü–∞ –¥–≤–∏–≥–∞–µ—Ç—Å—è –∫ —Ü–µ–Ω—Ç—Ä—É, –ø–æ—è–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è
  let chickVisible = false;
  let chickAtCenter = false;

  function showChick() {
    if (chickVisible) return;
    chickVisible = true;
    chick.style.left = window.innerWidth + 'px';
    chick.style.display = 'block';

    setTimeout(() => {
      chick.style.left = (window.innerWidth / 2 - 30) + 'px'; // —Ü–µ–Ω—Ç—Ä —ç–∫—Ä–∞–Ω–∞ —Å –ø–æ–ø—Ä–∞–≤–∫–æ–π
    }, 100);

    setTimeout(() => {
      chickAtCenter = true;
      chick.textContent = 'üê•';
    }, 3100);
  }

  // –ü–æ—è–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã
  setInterval(() => {
    if (Date.now() - lastActivityTime > 120000 && !chickVisible) {
      showChick();
    }
  }, 5000);

  // –ï—Å–ª–∏ –Ω–∞–∂–∞—Ç—å –Ω–∞ –ø—Ç–µ–Ω—Ü–∞ - –æ–Ω –±—ã—Å—Ç—Ä–æ —É–±–µ–∂–∏—Ç –Ω–∞–ª–µ–≤–æ –∑–∞ —ç–∫—Ä–∞–Ω
  chick.addEventListener('click', () => {
    if (!chickAtCenter) return;

    chick.style.transition = 'left 0.7s linear';
    chick.style.left = '-100px';

    chickAtCenter = false;
    chickVisible = false;

    showThought();
    thoughtBubble.textContent = 'üò≥';

    setTimeout(() => {
      chick.style.display = 'none';
      changeThought();
    }, 800);
  });

  // –®–∞—Ä–∏–∫ üéà - –ø–æ—è–≤–∏—Ç—Å—è —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö, –µ—Å–ª–∏ 1 –º–∏–Ω—É—Ç–∞ –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è –∏ –Ω–µ—Ç –ø—Ç–µ–Ω—Ü–∞ —Å–µ–π—á–∞—Å
  const balloon = document.createElement('div');
  balloon.textContent = 'üéà';
  balloon.style.position = 'fixed';
  balloon.style.fontSize = '42px';
  balloon.style.left = '50%';
  balloon.style.bottom = '-60px';
  balloon.style.transform = 'translateX(-50%)';
  balloon.style.cursor = 'pointer';
  balloon.style.userSelect = 'none';
  balloon.style.zIndex = '100';
  balloon.style.transition = 'bottom 8s linear';
  balloon.style.display = 'none';

  document.body.appendChild(balloon);

  function showBalloon() {
    if (balloon.style.display === 'block') return;
    balloon.style.display = 'block';
    balloon.style.bottom = '-60px';

    setTimeout(() => {
      balloon.style.bottom = '110vh';
    }, 100);

    // –°–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 9 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
      balloon.style.display = 'none';
    }, 9000);
  }

  // –ü–æ—è–≤–ª–µ–Ω–∏–µ —à–∞—Ä–∏–∫–∞ —á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è (–µ—Å–ª–∏ –ø—Ç–µ–Ω—Ü–∞ –Ω–µ—Ç)
  setInterval(() => {
    if (Date.now() - lastActivityTime > 60000 && !chickVisible && balloon.style.display === 'none') {
      showBalloon();
    }
  }, 6000);

  // –®–∞—Ä–∏–∫ –º–æ–∂–Ω–æ –ª–æ–≤–∏—Ç—å, –µ—Å–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å | –∏–ª–∏ __ –ø–æ–¥ –Ω–µ–≥–æ - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–æ–∑–ª–µ –Ω–∏—Ö
  balloon.addEventListener('click', () => {
    balloon.style.transition = 'bottom 1s ease-in-out, left 1s ease-in-out';
    balloon.style.bottom = '20px';
    balloon.style.left = '90px';
    setTimeout(() => {
      balloon.style.display = 'none';
    }, 1100);
  });

  // –°–±—Ä–æ—Å idle –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
  [balloon, chick, yukkiContainer].forEach(el => {
    el.addEventListener('click', () => updateActivity());
  });

  // -----------------------------------------------------

  // –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ (–µ—Å–ª–∏ —Ö–æ—á–µ—à—å, –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π)
  /*
  const bgMusic = new Audio('https://your-audio-link.mp3');
  bgMusic.loop = true;
  bgMusic.volume = 0.1;
  bgMusic.play();
  */

  // –°—Ç–∞—Ä—Ç
  Engine.run(engine);

  // –ù–µ–º–Ω–æ–≥–æ –º–∞–≥–∏–∏ ‚Äî –ø–ª–∞–≤–Ω–æ –≤—ã–∫–ª—é—á–∞–µ–º –ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–≥–¥–∞ –æ–Ω–∏ –∑–∞–º–µ–¥–ª—è—é—Ç—Å—è
  Events.on(engine, 'afterUpdate', () => {
    [ball, bone, toyBall].forEach(obj => {
      if (!obj.isSleeping && Math.abs(obj.velocity.x) < 0.02 && Math.abs(obj.velocity.y) < 0.02) {
        Body.setVelocity(obj, {x:0, y:0});
        obj.isSleeping = true;
      }
    });
  });
</script>
</body>
</html>
